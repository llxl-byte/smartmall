<!-- Generated by SpecStory -->

# æœ¬ç§‘è®ºæ–‡ç³»ç»Ÿå®ç°ä»£ç æ›¿æ¢æŒ‡å¯¼ (2025-05-09 13:37:37)

_**User**_

ä»¥ä¸‹å†…å®¹æ˜¯æˆ‘æœ¬ç§‘è®ºæ–‡åˆç¨¿çš„ç³»ç»Ÿå®ç°éƒ¨åˆ†ï¼Œç³»ç»Ÿå®ç°éƒ¨åˆ†çš„ä»£ç æ˜¯æœ€ä½³å®è·µçš„ç¤ºä¾‹ä»£ç ï¼Œä½ ç°åœ¨å‘Šè¯‰æˆ‘æˆ‘åº”è¯¥å¦‚ä½•å°†å…¶æ›¿æ¢ä¸ºè¿™ä¸ªé¡¹ç›®çš„ä»£ç ã€‚åˆç¨¿ç³»ç»Ÿå®ç°éƒ¨åˆ†å†…å®¹å¯ä»¥æ ¹æ®é¡¹ç›®åŠ¨æ€è°ƒæ•´ï¼š 
5.1 ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½çš„å®ç°
ç”¨æˆ·æ³¨å†Œæ˜¯æ–°ç”¨æˆ·è¿›å…¥ç³»ç»Ÿçš„å¿…è¦æ­¥éª¤ã€‚å®ç°è¿‡ç¨‹æ¶µç›–å‰ç«¯æ•°æ®é‡‡é›†ä¸æ ¡éªŒã€åç«¯æ•°æ®æ¥æ”¶ã€ä¸šåŠ¡é€»è¾‘å¤„ç†ã€å¯†ç åŠ å¯†å­˜å‚¨ä»¥åŠæ•°æ®æŒä¹…åŒ–ã€‚
å‰ç«¯å®ç°æ¦‚è¦ï¼š
ç”¨æˆ·ç«¯å‰ç«¯æä¾›æ³¨å†Œè¡¨å•ï¼Œé€šè¿‡ uni.request æˆ– Axios å‘åç«¯å‘é€æ³¨å†Œè¯·æ±‚ã€‚åœ¨å‘é€è¯·æ±‚å‰ï¼Œè¿›è¡ŒåŸºæœ¬çš„å®¢æˆ·ç«¯è¾“å…¥æ ¡éªŒã€‚
// ä»£ç æ¸…å• 5-1 ç”¨æˆ·ç«¯æ³¨å†Œè¯·æ±‚ç¤ºä¾‹ (ä½¿ç”¨uni.request)
// file: smart_mall_hx_cr_new/pages/auth/register.vue

methods: {
  async register() {
    // å‡è®¾ userData åŒ…å«ç”¨æˆ·åã€å¯†ç ç­‰è¡¨å•æ•°æ®
    if (this.validateForm(this.userData)) { // æœ¬åœ°æ ¡éªŒæ–¹æ³•
      try {
        const response = await uni.request({
          url: 'YOUR_BACKEND_API_BASE_URL/api/user/register', // æ›¿æ¢ä¸ºä½ çš„åç«¯æ³¨å†Œæ¥å£åœ°å€
          method: 'POST',
          data: this.userData,
          header: {
            'Content-Type': 'application/json'
          }
        });

        if (response.statusCode === 200) {
          // æ³¨å†ŒæˆåŠŸ
          console.log('æ³¨å†ŒæˆåŠŸ', response.data);
          uni.showToast({ title: 'æ³¨å†ŒæˆåŠŸ', icon: 'success' });
          setTimeout(() => {
            uni.navigateTo({ url: '/pages/auth/login' }); // è·³è½¬åˆ°ç™»å½•é¡µ
          }, 1500);
        } else {
          // æ³¨å†Œå¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
          console.error('æ³¨å†Œå¤±è´¥', response.data);
          uni.showToast({ title: response.data.message || 'æ³¨å†Œå¤±è´¥ï¼Œè¯·é‡è¯•', icon: 'none' });
        }
      } catch (error) {
        console.error('è¯·æ±‚å‘é€å¤±è´¥', error);
        uni.showToast({ title: 'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', icon: 'none' });
      }
    }
  },
  validateForm(data) {
    // å®ç°æœ¬åœ°æ ¡éªŒé€»è¾‘ï¼Œä¾‹å¦‚æ£€æŸ¥ç”¨æˆ·åã€å¯†ç æ ¼å¼ç­‰
    // è¿”å› true æˆ– false
    return true; // ç¤ºä¾‹ï¼Œè¯·æ›¿æ¢ä¸ºå®é™…æ ¡éªŒé€»è¾‘
  }
}

ä»£ç è¯´æ˜ï¼š ä¸Šè¿°ä»£ç å±•ç¤ºäº†ç”¨æˆ·ç«¯æ³¨å†Œé¡µé¢ä¸­ï¼Œä½¿ç”¨ uni.request å‘é€ POST è¯·æ±‚åˆ°åç«¯æ³¨å†Œæ¥å£çš„ç¤ºä¾‹ã€‚åŒ…å«äº†æœ¬åœ°æ ¡éªŒã€è¯·æ±‚å‘é€ã€æˆåŠŸå’Œå¤±è´¥çš„å“åº”å¤„ç†é€»è¾‘ã€‚
åç«¯å®ç°æ¦‚è¦ï¼š
åç«¯ä½¿ç”¨ Spring Boot Controller æ¥æ”¶æ³¨å†Œè¯·æ±‚ï¼Œé€šè¿‡ Service å±‚è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œåˆ©ç”¨ Spring Security çš„ PasswordEncoder è¿›è¡Œå¯†ç åŠ å¯†ï¼Œå¹¶é€šè¿‡ MyBatis å°†æ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“ã€‚
// ä»£ç æ¸…å• 5-2 åç«¯ç”¨æˆ·æ³¨å†Œ Controller æ–¹æ³•ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/yourcompany/controller/UserController.java

@RestController
@RequestMapping("/api/user")
public class UserController {

    @Autowired
    private UserService userService;

    @PostMapping("/register")
    public ResponseEntity<?> register(@RequestBody UserRegisterParam registerParam) {
        // è¾“å…¥å‚æ•°æ ¡éªŒ (ä¾‹å¦‚ä½¿ç”¨ @Valid æ³¨è§£å’Œ BindingResult)
        if (userService.isUsernameExists(registerParam.getUsername())) {
            return ResponseEntity.badRequest().body(CommonResult.failed("ç”¨æˆ·åå·²å­˜åœ¨"));
        }
        if (userService.isMobileExists(registerParam.getMobile())) {
             return ResponseEntity.badRequest().body(CommonResult.failed("æ‰‹æœºå·å·²å­˜åœ¨"));
        }

        int count = userService.register(registerParam);
        if (count > 0) {
            return ResponseEntity.ok(CommonResult.success("æ³¨å†ŒæˆåŠŸ"));
        } else {
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(CommonResult.failed("æ³¨å†Œå¤±è´¥ï¼Œè¯·é‡è¯•"));
        }
    }

    // UserRegisterParam æ˜¯ä¸€ä¸ªç”¨äºæ¥æ”¶æ³¨å†Œè¯·æ±‚å‚æ•°çš„DTOç±»
}

// ä»£ç æ¸…å• 5-3 åç«¯ç”¨æˆ·æ³¨å†Œ Service é€»è¾‘ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/yourcompany/service/impl/UserServiceImpl.java

@Service
public class UserServiceImpl implements UserService {

    @Autowired
    private MallUserMapper userMapper; // MyBatis Mapper æ¥å£
    @Autowired
    private PasswordEncoder passwordEncoder; // Spring Security å¯†ç ç¼–ç å™¨

    @Override
    public int register(UserRegisterParam registerParam) {
        MallUser user = new MallUser();
        user.setUsername(registerParam.getUsername());
        // å¯†ç åŠ å¯†å­˜å‚¨
        user.setPassword(passwordEncoder.encode(registerParam.getPassword()));
        user.setMobile(registerParam.getMobile());
        user.setCreateTime(new Date());
        user.setStatus(1); // é»˜è®¤å¯ç”¨çŠ¶æ€

        // è°ƒç”¨ Mapper æ’å…¥æ•°æ®åº“
        return userMapper.insert(user);
    }

     @Override
     public boolean isUsernameExists(String username) {
         // è°ƒç”¨ Mapper æŸ¥è¯¢ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
         return userMapper.countByUsername(username) > 0;
     }

    @Override
    public boolean isMobileExists(String mobile) {
         // è°ƒç”¨ Mapper æŸ¥è¯¢æ‰‹æœºå·æ˜¯å¦å­˜åœ¨
         return userMapper.countByMobile(mobile) > 0;
    }

    // å…¶ä»–ç”¨æˆ·ç›¸å…³æœåŠ¡æ–¹æ³•
}

ä»£ç è¯´æ˜ï¼š UserController è´Ÿè´£æ¥æ”¶ HTTP è¯·æ±‚å¹¶è°ƒç”¨ UserServiceã€‚UserServiceImpl å®ç°äº†æ³¨å†Œçš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬æ ¡éªŒç”¨æˆ·å/æ‰‹æœºå·æ˜¯å¦å­˜åœ¨ã€ä½¿ç”¨ passwordEncoder.encode() æ–¹æ³•å¯¹å¯†ç è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†ç”¨æˆ·ä¿¡æ¯é€šè¿‡ userMapper.insert() æ’å…¥åˆ°æ•°æ®åº“ä¸­ã€‚
5.2 ç”¨æˆ·ç™»å½•åŠŸèƒ½çš„å®ç°
ç”¨æˆ·ç™»å½•é€šè¿‡éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œå¹¶ä¸ºå…¶é¢å‘ç”¨äºåç»­è®¿é—®å—ä¿æŠ¤èµ„æºçš„ JWT ä»¤ç‰Œã€‚
å‰ç«¯å®ç°æ¦‚è¦ï¼š
ç”¨æˆ·ç«¯/ç®¡ç†ç«¯å‰ç«¯æä¾›ç™»å½•è¡¨å•ï¼Œé‡‡é›†ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶é€šè¿‡ HTTP POST è¯·æ±‚å‘é€åˆ°åç«¯ç™»å½•æ¥å£ã€‚ç™»å½•æˆåŠŸåï¼Œå°†åç«¯è¿”å›çš„ JWT ä»¤ç‰Œå­˜å‚¨åœ¨æœ¬åœ°ã€‚
// ä»£ç æ¸…å• 5-4 ç”¨æˆ·ç«¯ç™»å½•è¯·æ±‚ç¤ºä¾‹ (ä½¿ç”¨uni.request)
// file: smart_mall_hx_cr_new/pages/auth/login.vue

methods: {
  async login() {
    // å‡è®¾ loginData åŒ…å«ç”¨æˆ·åå’Œå¯†ç 
    if (this.validateForm(this.loginData)) { // æœ¬åœ°æ ¡éªŒæ–¹æ³•
      try {
        const response = await uni.request({
          url: 'YOUR_BACKEND_API_BASE_URL/api/auth/login', // æ›¿æ¢ä¸ºä½ çš„åç«¯ç™»å½•æ¥å£åœ°å€
          method: 'POST',
          data: this.loginData,
          header: {
            'Content-Type': 'application/json'
          }
        });

        if (response.statusCode === 200 && response.data.code === 200) {
          // ç™»å½•æˆåŠŸï¼Œè·å– JWT ä»¤ç‰Œ
          const token = response.data.data.token; // å‡è®¾åç«¯è¿”å›ç»“æ„æ˜¯ CommonResult<Map<String, String>>ï¼Œdataä¸­åŒ…å«token
          const user = response.data.data.user; // å‡è®¾åç«¯åŒæ—¶è¿”å›ç”¨æˆ·åŸºæœ¬ä¿¡æ¯

          uni.setStorageSync('token', token); // å­˜å‚¨ JWT ä»¤ç‰Œ
          uni.setStorageSync('userInfo', user); // å­˜å‚¨ç”¨æˆ·ä¿¡æ¯

          console.log('ç™»å½•æˆåŠŸ', response.data);
          uni.showToast({ title: 'ç™»å½•æˆåŠŸ', icon: 'success' });
          setTimeout(() => {
            uni.switchTab({ url: '/pages/index/index' }); // è·³è½¬åˆ°é¦–é¡µ
          }, 1500);

        } else {
          // ç™»å½•å¤±è´¥
          console.error('ç™»å½•å¤±è´¥', response.data);
          uni.showToast({ title: response.data.message || 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯', icon: 'none' });
        }
      } catch (error) {
        console.error('è¯·æ±‚å‘é€å¤±è´¥', error);
        uni.showToast({ title: 'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', icon: 'none' });
      }
    }
  },
  validateForm(data) {
     // å®ç°æœ¬åœ°æ ¡éªŒé€»è¾‘
     return true; // ç¤ºä¾‹
  }
}

ä»£ç è¯´æ˜ï¼š ç”¨æˆ·ç«¯ç™»å½•é¡µé¢é€šè¿‡ uni.request å‘é€ç™»å½•è¯·æ±‚ï¼ŒæˆåŠŸåä»å“åº”ä¸­è·å– JWT ä»¤ç‰Œå¹¶ä½¿ç”¨ uni.setStorageSync å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä»¥ä¾¿åç»­è¯·æ±‚æºå¸¦ã€‚
åç«¯å®ç°æ¦‚è¦ï¼š
åç«¯ä½¿ç”¨ Spring Security æä¾›è®¤è¯æœåŠ¡ï¼Œè®¤è¯æˆåŠŸåï¼Œç”Ÿæˆ JWT ä»¤ç‰Œå¹¶è¿”å›ç»™å‰ç«¯ã€‚
// ä»£ç æ¸…å• 5-5 åç«¯ç™»å½•æ¥å£ Controller æ–¹æ³•ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/yourcompany/controller/AuthController.java

@RestController
@RequestMapping("/api/auth")
public class AuthController {

    @Autowired
    private AuthService authService; // è®¤è¯æœåŠ¡

    @PostMapping("/login")
    public ResponseEntity<?> login(@RequestBody UserLoginParam loginParam) {
        // è¾“å…¥å‚æ•°æ ¡éªŒ
        String token = authService.login(loginParam.getUsername(), loginParam.getPassword());
        if (token == null) {
            return ResponseEntity.badRequest().body(CommonResult.validateFailed("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"));
        }
        Map<String, String> tokenMap = new HashMap<>();
        tokenMap.put("token", token);
        // å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨æ­¤å¤„è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ä¸€åŒè¿”å›
        // UserDetails userDetails = authService.loadUserByUsername(loginParam.getUsername());
        // tokenMap.put("user", ...);
        return ResponseEntity.ok(CommonResult.success(tokenMap, "ç™»å½•æˆåŠŸ"));
    }

    // UserLoginParam æ˜¯ç”¨äºæ¥æ”¶ç™»å½•è¯·æ±‚å‚æ•°çš„DTOç±»
}

// ä»£ç æ¸…å• 5-6 åç«¯è®¤è¯ Service é€»è¾‘ç¤ºä¾‹ (ç®€åŒ–)
// file: smart_mall_li_cr_springboot2/src/main/java/com/yourcompany/service/AuthService.java
public interface AuthService {
    /**
     * ç”¨æˆ·ç™»å½•å¹¶ç”ŸæˆJWT
     * @param username ç”¨æˆ·å
     * @param password å¯†ç 
     * @return ç”Ÿæˆçš„JWT
     */
    String login(String username, String password);

    // UserDetails loadUserByUsername(String username); // å¯èƒ½åœ¨Spring Securityé…ç½®ä¸­ä½¿ç”¨
}

// file: smart_mall_li_cr_springboot2/src/main/java/com/yourcompany/service/impl/AuthServiceImpl.java
@Service
public class AuthServiceImpl implements AuthService {

    @Autowired
    private AuthenticationManager authenticationManager; // Spring Security è®¤è¯ç®¡ç†å™¨
    @Autowired
    private JwtTokenUtil jwtTokenUtil; // JWT å·¥å…·ç±»
    @Autowired
    private UserDetailsService userDetailsService; // Spring Security ç”¨æˆ·è¯¦æƒ…æœåŠ¡

    @Override
    public String login(String username, String password) {
        UsernamePasswordAuthenticationToken authenticationToken = new UsernamePasswordAuthenticationToken(username, password);
        try {
            // è°ƒç”¨è®¤è¯ç®¡ç†å™¨è¿›è¡Œèº«ä»½éªŒè¯
            Authentication authentication = authenticationManager.authenticate(authenticationToken);
            // è®¤è¯æˆåŠŸï¼Œè·å–ç”¨æˆ·è¯¦æƒ…å¹¶ç”ŸæˆJWT
            UserDetails userDetails = (UserDetails) authentication.getPrincipal();
            return jwtTokenUtil.generateToken(userDetails);
        } catch (AuthenticationException e) {
            // è®¤è¯å¤±è´¥
            return null;
        }
    }

    // JwtTokenUtil æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆå’Œè§£æ JWT çš„å·¥å…·ç±»
}

ä»£ç è¯´æ˜ï¼š åç«¯åˆ©ç”¨ Spring Security çš„ AuthenticationManager è¿›è¡Œç”¨æˆ·åå’Œå¯†ç çš„éªŒè¯ã€‚éªŒè¯æˆåŠŸåï¼Œé€šè¿‡è‡ªå®šä¹‰çš„ JwtTokenUtil ç”Ÿæˆ JWT ä»¤ç‰Œã€‚UserDetailsService ç”¨äºä»æ•°æ®åº“åŠ è½½ç”¨æˆ·è¯¦æƒ…ä¾› Spring Security ä½¿ç”¨ã€‚
5.3 å•†å“ç®¡ç†åŠŸèƒ½çš„å®ç°
ä»¥å•†å“åˆ—è¡¨æŸ¥è¯¢ä¸ºä¾‹ï¼Œå±•ç¤ºåç«¯å¦‚ä½•å¤„ç†è¯·æ±‚å¹¶è¿”å›æ•°æ®ï¼Œä»¥åŠç®¡ç†ç«¯å‰ç«¯å¦‚ä½•å±•ç¤ºã€‚
åç«¯å®ç°æ¦‚è¦ï¼š
Controller æ¥æ”¶å•†å“æŸ¥è¯¢è¯·æ±‚ï¼ŒService è°ƒç”¨ Mapper æŸ¥è¯¢æ•°æ®åº“ï¼Œå¯èƒ½æ¶‰åŠåˆ†é¡µå’Œæ¡ä»¶è¿‡æ»¤ã€‚
// ä»£ç æ¸…å• 5-7 åç«¯å•†å“åˆ—è¡¨æŸ¥è¯¢ Controller æ–¹æ³•ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/yourcompany/controller/ItemController.java

@RestController
@RequestMapping("/api/item")
public class ItemController {

    @Autowired
    private ItemService itemService;

    @GetMapping("/list")
    public ResponseEntity<?> list(
            @RequestParam(value = "keyword", required = false) String keyword,
            @RequestParam(value = "categoryId", required = false) Long categoryId,
            @RequestParam(value = "pageSize", defaultValue = "10") Integer pageSize,
            @RequestParam(value = "pageNum", defaultValue = "1") Integer pageNum) {

        PageInfo<Item> itemList = itemService.list(keyword, categoryId, pageSize, pageNum);
        return ResponseEntity.ok(CommonResult.success(CommonPage.restPage(itemList)));
    }

    // Item æ˜¯å•†å“å®ä½“ç±»ï¼ŒCommonPage æ˜¯åˆ†é¡µç»“æœå°è£…ç±»
}

// ä»£ç æ¸…å• 5-8 åç«¯å•†å“åˆ—è¡¨æŸ¥è¯¢ Service é€»è¾‘ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/yourcompany/service/impl/ItemServiceImpl.java

@Service
public class ItemServiceImpl implements ItemService {

    @Autowired
    private ItemMapper itemMapper; // MyBatis Mapper æ¥å£

    @Override
    public PageInfo<Item> list(String keyword, Long categoryId, Integer pageSize, Integer pageNum) {
        PageHelper.startPage(pageNum, pageSize); // PageHelper åˆ†é¡µæ’ä»¶
        // è°ƒç”¨ Mapper æ ¹æ®æ¡ä»¶æŸ¥è¯¢å•†å“åˆ—è¡¨
        List<Item> itemList = itemMapper.selectList(keyword, categoryId);
        return new PageInfo<>(itemList);
    }
}

// ä»£ç æ¸…å• 5-9 åç«¯å•†å“åˆ—è¡¨æŸ¥è¯¢ Mapper XML ç¤ºä¾‹ (ç‰‡æ®µ)
/*
<mapper namespace="com.yourcompany.mapper.ItemMapper">
    <select id="selectList" resultType="com.yourcompany.model.Item">
        SELECT
            id, name, price, stock, category_id, ...
        FROM
            item
        <where>
            <if test="keyword != null and keyword != ''">
                AND name LIKE CONCAT('%', #{keyword}, '%')
            </if>
            <if test="categoryId != null">
                AND category_id = #{categoryId}
            </if>
        </where>
        ORDER BY create_time DESC
    </select>
</mapper>
*/

ä»£ç è¯´æ˜ï¼š ItemController æ¥æ”¶æŸ¥è¯¢å‚æ•°ï¼Œè°ƒç”¨ ItemServiceã€‚ItemService ä½¿ç”¨ PageHelper åˆ†é¡µæ’ä»¶è®¾ç½®åˆ†é¡µå‚æ•°ï¼Œç„¶åè°ƒç”¨ ItemMapper æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢ã€‚ItemMapper.xml ä¸­å®šä¹‰äº† SQL è¯­å¥ï¼Œæ”¯æŒæŒ‰å…³é”®è¯å’Œåˆ†ç±»IDè¿‡æ»¤ã€‚
ç®¡ç†ç«¯å‰ç«¯å®ç°æ¦‚è¦ï¼š
ç®¡ç†ç«¯å‰ç«¯ä½¿ç”¨ Vue.js å’Œ Element Plus æ„å»ºå•†å“åˆ—è¡¨é¡µé¢ï¼Œé€šè¿‡ Axios è°ƒç”¨åç«¯æ¥å£è·å–æ•°æ®ï¼Œå¹¶åœ¨è¡¨æ ¼ä¸­å±•ç¤ºã€‚
// ä»£ç æ¸…å• 5-10 ç®¡ç†ç«¯å•†å“åˆ—è¡¨é¡µé¢è·å–æ•°æ®ç¤ºä¾‹ (ä½¿ç”¨ Axios)
// file: smart_mall_admin_vue/src/views/item/ItemList.vue

import request from '@/utils/request'; // å°è£…çš„ Axios å®ä¾‹

export default {
  data() {
    return {
      list: [],
      listQuery: { // æŸ¥è¯¢å‚æ•°
        keyword: null,
        categoryId: null,
        pageSize: 10,
        pageNum: 1
      },
      total: 0,
      listLoading: false
    };
  },
  created() {
    this.getList();
  },
  methods: {
    getList() {
      this.listLoading = true;
      request({
        url: '/item/list', // è°ƒç”¨åç«¯æ¥å£
        method: 'get',
        params: this.listQuery // ä¼ é€’æŸ¥è¯¢å‚æ•°
      }).then(response => {
        this.listLoading = false;
        this.list = response.data.list; // å‡è®¾åç«¯è¿”å›ç»“æ„åŒ…å« data.list
        this.total = response.data.total; // å‡è®¾åç«¯è¿”å›ç»“æ„åŒ…å« data.total
      }).catch(() => {
        this.listLoading = false;
      });
    },
    handleSearchList() {
      this.listQuery.pageNum = 1;
      this.getList();
    },
    handleSizeChange(val) {
      this.listQuery.pageNum = 1;
      this.listQuery.pageSize = val;
      this.getList();
    },
    handleCurrentChange(val) {
      this.listQuery.pageNum = val;
      this.getList();
    }
    // å…¶ä»–æ“ä½œæ–¹æ³•ï¼Œå¦‚åˆ é™¤ã€ç¼–è¾‘ç­‰
  }
};

ä»£ç è¯´æ˜ï¼š ç®¡ç†ç«¯ Vue ç»„ä»¶åœ¨åˆ›å»ºæ—¶è°ƒç”¨ getList æ–¹æ³•è·å–å•†å“åˆ—è¡¨æ•°æ®ã€‚getList æ–¹æ³•ä½¿ç”¨å°è£…çš„ Axios å®ä¾‹å‘åç«¯å‘é€ GET è¯·æ±‚ï¼Œå¹¶å°†æŸ¥è¯¢å‚æ•° listQuery ä½œä¸ºè¯·æ±‚å‚æ•°ã€‚è·å–åˆ°å“åº”åï¼Œæ›´æ–°ç»„ä»¶çš„ list å’Œ total æ•°æ®ï¼ŒElement Plus è¡¨æ ¼ä¼šè‡ªåŠ¨æ¸²æŸ“æ•°æ®ã€‚
5.4 è®¢å•åˆ›å»ºåŠŸèƒ½çš„å®ç°ï¼ˆæ¶‰åŠé«˜å¹¶å‘å’Œäº‹åŠ¡ï¼‰
è®¢å•åˆ›å»ºæ˜¯ä¸šåŠ¡æµç¨‹çš„æ ¸å¿ƒï¼Œéœ€è¦å¤„ç†åº“å­˜æ£€æŸ¥å’Œæ‰£å‡ï¼Œå¹¶ä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚
åç«¯å®ç°æ¦‚è¦ï¼š
åç«¯æ¥æ”¶è®¢å•è¯·æ±‚ï¼Œæ¶‰åŠç”¨æˆ·ã€å•†å“ã€æ”¶è´§åœ°å€ç­‰ä¿¡æ¯ã€‚åœ¨å¤„ç†è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è¿›è¡Œåº“å­˜æ£€æŸ¥ï¼Œå¹¶åœ¨ç¡®è®¤ä¸‹å•åæ‰£å‡åº“å­˜ã€‚æ•´ä¸ªè¿‡ç¨‹å¿…é¡»åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å®Œæˆï¼Œä»¥ç¡®ä¿è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚
// ä»£ç æ¸…å• 5-11 åç«¯è®¢å•åˆ›å»º Service æ–¹æ³•ç¤ºä¾‹ (ç‰‡æ®µï¼Œçªå‡ºäº‹åŠ¡å’Œåº“å­˜å¤„ç†)
// file: smart_mall_li_cr_springboot2/src/main/java/com/yourcompany/service/impl/OrderServiceImpl.java

@Service
public class OrderServiceImpl implements OrderService {

    @Autowired
    private MallOrderMapper orderMapper;
    @Autowired
    private OrderDetailMapper orderDetailMapper;
    @Autowired
    private ItemMapper itemMapper; // ç”¨äºæ›´æ–°åº“å­˜

    @Transactional // å£°æ˜äº‹åŠ¡
    @Override
    public int createOrder(CreateOrderParam orderParam) {
        // 1. æ ¡éªŒæ”¶è´§åœ°å€ã€è·å–ç”¨æˆ·ä¿¡æ¯ç­‰...

        // 2. æ£€æŸ¥å¹¶é”å®šåº“å­˜ (ä¹è§‚é”ç¤ºä¾‹)
        List<OrderItemParam> orderItems = orderParam.getOrderItems();
        for (OrderItemParam itemParam : orderItems) {
            Item item = itemMapper.selectById(itemParam.getItemId());
            if (item == null || item.getStock() < itemParam.getQuantity()) {
                throw new BusinessException("å•†å“åº“å­˜ä¸è¶³ï¼š" + item.getName()); // åº“å­˜ä¸è¶³æŠ›å‡ºå¼‚å¸¸ï¼Œäº‹åŠ¡å›æ»š
            }
            // å°è¯•æ›´æ–°åº“å­˜ï¼Œä½¿ç”¨ç‰ˆæœ¬å·å®ç°ä¹è§‚é”
            int updateCount = itemMapper.decreaseStock(item.getId(), itemParam.getQuantity(), item.getVersion());
            if (updateCount == 0) {
                throw new BusinessException("å•†å“åº“å­˜å·²è¢«ä¿®æ”¹ï¼Œè¯·é‡è¯•ï¼š" + item.getName()); // ç‰ˆæœ¬å·ä¸ä¸€è‡´ï¼Œäº‹åŠ¡å›æ»š
            }
        }

        // 3. ç”Ÿæˆè®¢å•ä¸»ä¿¡æ¯
        MallOrder order = new MallOrder();
        // è®¾ç½®è®¢å•å·ã€ç”¨æˆ·IDã€æ€»é‡‘é¢ã€çŠ¶æ€ç­‰...
        order.setCreateTime(new Date());
        order.setStatus(0); // å¾…æ”¯ä»˜

        // 4. æ’å…¥è®¢å•ä¸»ä¿¡æ¯
        orderMapper.insert(order); // æ’å…¥åè·å–ç”Ÿæˆçš„è®¢å•ID

        // 5. æ’å…¥è®¢å•è¯¦æƒ…
        for (OrderItemParam itemParam : orderItems) {
            OrderDetail orderDetail = new OrderDetail();
            orderDetail.setOrderId(order.getId());
            orderDetail.setItemId(itemParam.getItemId());
            orderDetail.setItemQuantity(itemParam.getQuantity());
            orderDetail.setItemPrice(itemParam.getPrice());
            // å…¶ä»–è¯¦æƒ…å­—æ®µ...
            orderDetailMapper.insert(orderDetail);
        }

        // 6. æ¸…ç©ºè´­ç‰©è½¦ä¸­å·²ä¸‹å•å•†å“ (å¦‚æœè®¢å•æ¥æºäºè´­ç‰©è½¦)

        // 7. è¿”å›è®¢å•IDæˆ–å…¶ä»–ä¿¡æ¯
        return 1; // è¡¨ç¤ºæˆåŠŸ
    }

    // å…¶ä»–è®¢å•ç›¸å…³æœåŠ¡æ–¹æ³•
}

// ä»£ç æ¸…å• 5-12 åº“å­˜æ›´æ–° Mapper XML ç‰‡æ®µ (ä¹è§‚é”)
/*
<mapper namespace="com.yourcompany.mapper.ItemMapper">
    <update id="decreaseStock">
        UPDATE item
        SET stock = stock - #{quantity}, version = version + 1
        WHERE id = #{itemId} AND stock >= #{quantity} AND version = #{version}
    </update>
</mapper>
*/

ä»£ç è¯´æ˜ï¼š createOrder æ–¹æ³•é€šè¿‡ @Transactional æ³¨è§£ç¡®ä¿æ•´ä¸ªæµç¨‹ï¼ˆåº“å­˜æ£€æŸ¥æ‰£å‡ã€è®¢å•æ’å…¥ï¼‰çš„åŸå­æ€§ã€‚åœ¨æ‰£å‡åº“å­˜æ—¶ï¼Œè°ƒç”¨ itemMapper.decreaseStock æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨ WHERE å­å¥ä¸­åŒæ—¶æ£€æŸ¥å•†å“IDã€åº“å­˜æ˜¯å¦è¶³å¤Ÿä»¥åŠç‰ˆæœ¬å·æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœæ›´æ–°æ•°é‡ä¸º0ï¼Œè¯´æ˜åº“å­˜ä¸è¶³æˆ–æ•°æ®å·²è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼Œæ­¤æ—¶æŠ›å‡ºå¼‚å¸¸è§¦å‘äº‹åŠ¡å›æ»šï¼Œå®ç°ä¹è§‚é”æ§åˆ¶ã€‚
5.5 æ¨èç³»ç»ŸåŠŸèƒ½çš„å®ç°ï¼ˆåŸºäºé”€é‡çƒ­é—¨æ¨èç¤ºä¾‹ï¼‰
æ™ºèƒ½æ¨èç³»ç»Ÿæ ¹æ®ä¸€å®šè§„åˆ™ä¸ºç”¨æˆ·æ¨èå•†å“ã€‚è¿™é‡Œä»¥ç®€å•çš„åŸºäºé”€é‡çš„çƒ­é—¨æ¨èä¸ºä¾‹ã€‚
åç«¯å®ç°æ¦‚è¦ï¼š
å®šæœŸç»Ÿè®¡å•†å“é”€é‡ï¼Œå¹¶å°†çƒ­é—¨å•†å“ä¿¡æ¯å­˜å‚¨æˆ–ç¼“å­˜èµ·æ¥ã€‚åœ¨ç”¨æˆ·è¯·æ±‚æ¨èæ—¶ï¼Œç›´æ¥è¿”å›çƒ­é—¨å•†å“åˆ—è¡¨ã€‚
// ä»£ç æ¸…å• 5-13 åç«¯çƒ­é—¨å•†å“æ¨è Service é€»è¾‘ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/yourcompany/service/impl/RecommendServiceImpl.java

@Service
public class RecommendServiceImpl implements RecommendService {

    @Autowired
    private ItemMapper itemMapper;
    @Autowired
    private RedisTemplate<String, Object> redisTemplate; // Redis æ¨¡æ¿

    private static final String HOT_ITEMS_CACHE_KEY = "recommend:hotItems";
    private static final long HOT_ITEMS_CACHE_TTL = 3600; // ç¼“å­˜1å°æ—¶

    /**
     * è·å–çƒ­é—¨å•†å“åˆ—è¡¨ (ä¼˜å…ˆä»ç¼“å­˜è·å–)
     * @param limit é™åˆ¶æ•°é‡
     * @return çƒ­é—¨å•†å“åˆ—è¡¨
     */
    @Override
    public List<Item> getHotItems(int limit) {
        // å°è¯•ä» Redis ç¼“å­˜è·å–
        List<Item> hotItems = (List<Item>) redisTemplate.opsForValue().get(HOT_ITEMS_CACHE_KEY);
        if (hotItems != null && !hotItems.isEmpty()) {
            return hotItems;
        }

        // ç¼“å­˜æœªå‘½ä¸­ï¼Œä»æ•°æ®åº“æŸ¥è¯¢ (å‡è®¾ Mapper æœ‰æŒ‰é”€é‡æ’åºçš„æ–¹æ³•)
        hotItems = itemMapper.selectHotItemsBySales(limit);

        // å°†ç»“æœå­˜å…¥ Redis ç¼“å­˜
        if (hotItems != null && !hotItems.isEmpty()) {
            redisTemplate.opsForValue().set(HOT_ITEMS_CACHE_KEY, hotItems, HOT_ITEMS_CACHE_TTL, TimeUnit.SECONDS);
        }

        return hotItems;
    }

    // userMapper ä¸­å¯èƒ½æœ‰ä¸€ä¸ª selectHotItemsBySales(int limit) æ–¹æ³•ï¼Œæ ¹æ®é”€é‡æ’åºæŸ¥è¯¢å•†å“
}

ä»£ç è¯´æ˜ï¼š getHotItems æ–¹æ³•é¦–å…ˆå°è¯•ä» Redis ç¼“å­˜ä¸­è·å–çƒ­é—¨å•†å“åˆ—è¡¨ï¼Œå¦‚æœç¼“å­˜æœªå‘½ä¸­ï¼Œåˆ™ä»æ•°æ®åº“æŸ¥è¯¢ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœå­˜å…¥ Redis è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚è¿™å‡è½»äº†æ•°æ®åº“å‹åŠ›ï¼Œæé«˜äº†æ¨èå“åº”é€Ÿåº¦ã€‚

---

_**Assistant**_

éå¸¸æ£’ï¼Œä½ å·²ç»æœ‰äº†è¯¦ç»†çš„ç³»ç»Ÿå®ç°åˆç¨¿ã€‚ä¸‹é¢æˆ‘ä¼šä¸€æ­¥æ­¥æ•™ä½ å¦‚ä½•å°†è¿™äº›â€œæœ€ä½³å®è·µç¤ºä¾‹ä»£ç â€æ›¿æ¢ä¸ºä½ è‡ªå·±é¡¹ç›®çš„çœŸå®ä»£ç ï¼Œå¹¶ä¸”æ¯ä¸€æ­¥éƒ½è¯¦ç»†è®²è§£ç›¸å…³çŸ¥è¯†ç‚¹ï¼Œå¸®åŠ©ä½ ç†è§£å’ŒåŠ¨æ‰‹å®ç°ã€‚æˆ‘ä»¬ä¼šåˆ†æ¨¡å—è¿›è¡Œï¼Œæ¯ä¸ªæ¨¡å—éƒ½åˆ†ä¸ºâ€œæŸ¥æ‰¾ä½ é¡¹ç›®çš„ç°æœ‰ä»£ç â€ã€â€œå¯¹æ¯”ä¸æ›¿æ¢â€ã€â€œæ³¨æ„äº‹é¡¹â€ä¸‰æ­¥ã€‚ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„è¿›åº¦é€æ­¥å®Œæˆã€‚

---
## ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œ

**1. ä½ éœ€è¦å…ˆæ˜ç¡®ä½ é¡¹ç›®çš„ç›®å½•ç»“æ„å’Œä¸»è¦ä»£ç æ–‡ä»¶ã€‚**  
æ¯”å¦‚ä½ çš„Spring Bootåç«¯ä»£ç ä¸€èˆ¬åœ¨ `src/main/java/ä½ çš„åŒ…å/` ä¸‹ï¼Œå‰ç«¯uniappä»£ç åœ¨ `pages/` ä¸‹ï¼Œç®¡ç†ç«¯vueä»£ç åœ¨ `src/views/` ä¸‹ã€‚

**2. ä½ éœ€è¦çŸ¥é“ä½ é¡¹ç›®ä¸­å„åŠŸèƒ½çš„å®é™…æ¥å£è·¯å¾„å’Œå‚æ•°åã€‚**  
æ¯”å¦‚æ³¨å†Œæ¥å£å®é™…æ˜¯ `/api/user/register` è¿˜æ˜¯åˆ«çš„ï¼Ÿå‚æ•°æ˜¯ `username` è¿˜æ˜¯ `userName`ï¼Ÿ  
è¿™äº›å¯ä»¥é€šè¿‡æŸ¥æ‰¾Controllerã€Serviceã€Mapperç­‰æ–‡ä»¶æ¥ç¡®è®¤ã€‚

---

## ç¬¬äºŒæ­¥ï¼šç”¨æˆ·æ³¨å†ŒåŠŸèƒ½æ›¿æ¢

### 1. æŸ¥æ‰¾ä½ é¡¹ç›®çš„æ³¨å†Œç›¸å…³ä»£ç 

#### åç«¯
- æ‰¾åˆ°ä½ åç«¯çš„ `UserController`ï¼ˆæˆ–ç±»ä¼¼å‘½åï¼‰æ–‡ä»¶ï¼ŒæŸ¥æ‰¾æ˜¯å¦æœ‰ `/register` çš„æ¥å£ã€‚
- æ‰¾åˆ° `UserService` åŠå…¶å®ç°ç±»ï¼ŒæŸ¥æ‰¾æ˜¯å¦æœ‰ `register` æ–¹æ³•ã€‚
- æ‰¾åˆ° `MallUserMapper` æˆ–ç±»ä¼¼çš„Mapperï¼ŒæŸ¥æ‰¾æ’å…¥ç”¨æˆ·çš„æ–¹æ³•ã€‚

#### å‰ç«¯
- æ‰¾åˆ°uniappå‰ç«¯çš„æ³¨å†Œé¡µé¢ï¼ˆå¦‚ `pages/auth/register.vue`ï¼‰ï¼ŒæŸ¥æ‰¾æ³¨å†Œè¡¨å•å’Œæäº¤æ–¹æ³•ã€‚

### 2. å¯¹æ¯”ä¸æ›¿æ¢

#### åç«¯
- å¯¹æ¯”ä½ çš„ `UserController` çš„æ³¨å†Œæ–¹æ³•å’Œç¤ºä¾‹ä»£ç ï¼Œç¡®è®¤å‚æ•°æ ¡éªŒã€ç”¨æˆ·å/æ‰‹æœºå·å”¯ä¸€æ€§æ ¡éªŒã€å¯†ç åŠ å¯†ã€æ’å…¥æ•°æ®åº“ç­‰é€»è¾‘æ˜¯å¦é½å…¨ã€‚
- å¦‚æœæœ‰ç¼ºå¤±ï¼Œå‚è€ƒç¤ºä¾‹ä»£ç è¡¥å……ç›¸å…³é€»è¾‘ã€‚
- ç¡®è®¤ `UserServiceImpl` æ˜¯å¦ç”¨åˆ°äº† `PasswordEncoder` è¿›è¡Œå¯†ç åŠ å¯†ï¼Œå¦‚æœæ²¡æœ‰ï¼ŒæŒ‰ç¤ºä¾‹è¡¥å……ã€‚
- ç¡®è®¤ `MallUserMapper` æ˜¯å¦æœ‰æŒ‰ç”¨æˆ·å/æ‰‹æœºå·æŸ¥è¯¢çš„æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰ï¼Œè¡¥å……ã€‚

#### å‰ç«¯
- å¯¹æ¯”ä½ çš„æ³¨å†Œé¡µé¢æäº¤é€»è¾‘å’Œç¤ºä¾‹ä»£ç ï¼Œç¡®è®¤æ˜¯å¦æœ‰æœ¬åœ°æ ¡éªŒã€è¯·æ±‚å‘é€ã€æˆåŠŸ/å¤±è´¥æç¤ºã€è·³è½¬ç­‰ã€‚
- å¦‚æœæ²¡æœ‰ï¼Œå‚è€ƒç¤ºä¾‹ä»£ç è¡¥å……ã€‚

### 3. æ³¨æ„äº‹é¡¹
- å‰åç«¯æ¥å£è·¯å¾„ã€å‚æ•°åè¦ä¿æŒä¸€è‡´ã€‚
- å¯†ç ä¸€å®šè¦åŠ å¯†å­˜å‚¨ï¼Œä¸èƒ½æ˜æ–‡ã€‚
- æ³¨å†ŒæˆåŠŸåå»ºè®®è·³è½¬åˆ°ç™»å½•é¡µã€‚

---

## ç¬¬ä¸‰æ­¥ï¼šç”¨æˆ·ç™»å½•åŠŸèƒ½æ›¿æ¢

### 1. æŸ¥æ‰¾ä½ é¡¹ç›®çš„ç™»å½•ç›¸å…³ä»£ç 

#### åç«¯
- æ‰¾åˆ° `AuthController` æˆ–ç±»ä¼¼çš„è®¤è¯Controllerï¼ŒæŸ¥æ‰¾ `/login` æ¥å£ã€‚
- æ‰¾åˆ° `AuthService` åŠå…¶å®ç°ç±»ï¼ŒæŸ¥æ‰¾ `login` æ–¹æ³•ã€‚
- æ‰¾åˆ° `JwtTokenUtil` æˆ–ç±»ä¼¼çš„JWTå·¥å…·ç±»ã€‚

#### å‰ç«¯
- æ‰¾åˆ°uniappå‰ç«¯çš„ç™»å½•é¡µé¢ï¼ˆå¦‚ `pages/auth/login.vue`ï¼‰ï¼ŒæŸ¥æ‰¾ç™»å½•è¡¨å•å’Œæäº¤æ–¹æ³•ã€‚

### 2. å¯¹æ¯”ä¸æ›¿æ¢

#### åç«¯
- å¯¹æ¯”ä½ çš„ç™»å½•æ¥å£å’Œç¤ºä¾‹ä»£ç ï¼Œç¡®è®¤æ˜¯å¦ç”¨Spring Securityè¿›è¡Œè®¤è¯ï¼Œè®¤è¯æˆåŠŸåæ˜¯å¦ç”Ÿæˆå¹¶è¿”å›JWTã€‚
- å¦‚æœæ²¡æœ‰JWTç›¸å…³é€»è¾‘ï¼ŒæŒ‰ç¤ºä¾‹è¡¥å……ã€‚
- ç¡®è®¤ `AuthServiceImpl` æ˜¯å¦ç”¨åˆ°äº† `AuthenticationManager` å’Œ `JwtTokenUtil`ã€‚

#### å‰ç«¯
- å¯¹æ¯”ä½ çš„ç™»å½•é¡µé¢æäº¤é€»è¾‘å’Œç¤ºä¾‹ä»£ç ï¼Œç¡®è®¤æ˜¯å¦æœ‰æœ¬åœ°æ ¡éªŒã€è¯·æ±‚å‘é€ã€æˆåŠŸ/å¤±è´¥æç¤ºã€tokenå­˜å‚¨ã€é¡µé¢è·³è½¬ç­‰ã€‚
- å¦‚æœæ²¡æœ‰ï¼Œå‚è€ƒç¤ºä¾‹ä»£ç è¡¥å……ã€‚

### 3. æ³¨æ„äº‹é¡¹
- ç™»å½•æˆåŠŸåï¼Œå‰ç«¯è¦æŠŠtokenå­˜åˆ°æœ¬åœ°ï¼ˆå¦‚ `uni.setStorageSync`ï¼‰ã€‚
- åç»­æ‰€æœ‰éœ€è¦ç™»å½•çš„è¯·æ±‚éƒ½è¦å¸¦ä¸Štokenï¼ˆä¸€èˆ¬æ”¾åœ¨è¯·æ±‚å¤´çš„Authorizationå­—æ®µï¼‰ã€‚

---

## ç¬¬å››æ­¥ï¼šå•†å“ç®¡ç†åŠŸèƒ½æ›¿æ¢

### 1. æŸ¥æ‰¾ä½ é¡¹ç›®çš„å•†å“ç›¸å…³ä»£ç 

#### åç«¯
- æ‰¾åˆ° `ItemController` æˆ–ç±»ä¼¼çš„å•†å“Controllerï¼ŒæŸ¥æ‰¾ `/list` æ¥å£ã€‚
- æ‰¾åˆ° `ItemService` åŠå…¶å®ç°ç±»ï¼ŒæŸ¥æ‰¾ `list` æ–¹æ³•ã€‚
- æ‰¾åˆ° `ItemMapper` åŠå…¶XMLï¼ŒæŸ¥æ‰¾å•†å“æŸ¥è¯¢SQLã€‚

#### ç®¡ç†ç«¯å‰ç«¯
- æ‰¾åˆ°ç®¡ç†ç«¯çš„å•†å“åˆ—è¡¨é¡µé¢ï¼ˆå¦‚ `src/views/item/ItemList.vue`ï¼‰ï¼ŒæŸ¥æ‰¾è·å–å•†å“åˆ—è¡¨çš„è¯·æ±‚æ–¹æ³•ã€‚

### 2. å¯¹æ¯”ä¸æ›¿æ¢

#### åç«¯
- å¯¹æ¯”ä½ çš„å•†å“åˆ—è¡¨æ¥å£å’Œç¤ºä¾‹ä»£ç ï¼Œç¡®è®¤æ˜¯å¦æ”¯æŒåˆ†é¡µã€å…³é”®è¯ã€åˆ†ç±»ç­‰æŸ¥è¯¢æ¡ä»¶ã€‚
- å¦‚æœæ²¡æœ‰ï¼ŒæŒ‰ç¤ºä¾‹è¡¥å……ã€‚
- ç¡®è®¤SQLæ˜¯å¦æ”¯æŒæ¡ä»¶è¿‡æ»¤å’Œåˆ†é¡µã€‚

#### å‰ç«¯
- å¯¹æ¯”ä½ çš„å•†å“åˆ—è¡¨é¡µé¢å’Œç¤ºä¾‹ä»£ç ï¼Œç¡®è®¤æ˜¯å¦æœ‰åˆ†é¡µã€æœç´¢ã€è¡¨æ ¼å±•ç¤ºç­‰åŠŸèƒ½ã€‚
- å¦‚æœæ²¡æœ‰ï¼Œå‚è€ƒç¤ºä¾‹ä»£ç è¡¥å……ã€‚

### 3. æ³¨æ„äº‹é¡¹
- å‰åç«¯åˆ†é¡µå‚æ•°è¦ä¸€è‡´ï¼ˆå¦‚ `pageNum`ã€`pageSize`ï¼‰ã€‚
- æŸ¥è¯¢ç»“æœè¦å°è£…æˆç»Ÿä¸€æ ¼å¼è¿”å›ã€‚

---

## ç¬¬äº”æ­¥ï¼šè®¢å•åˆ›å»ºåŠŸèƒ½æ›¿æ¢

### 1. æŸ¥æ‰¾ä½ é¡¹ç›®çš„è®¢å•ç›¸å…³ä»£ç 

#### åç«¯
- æ‰¾åˆ° `OrderServiceImpl`ï¼ŒæŸ¥æ‰¾ `createOrder` æ–¹æ³•ã€‚
- æ‰¾åˆ° `MallOrderMapper`ã€`OrderDetailMapper`ã€`ItemMapper`ï¼ŒæŸ¥æ‰¾ç›¸å…³SQLã€‚

### 2. å¯¹æ¯”ä¸æ›¿æ¢

- å¯¹æ¯”ä½ çš„è®¢å•åˆ›å»ºé€»è¾‘å’Œç¤ºä¾‹ä»£ç ï¼Œç¡®è®¤æ˜¯å¦æœ‰åº“å­˜æ ¡éªŒã€ä¹è§‚é”ã€äº‹åŠ¡æ§åˆ¶ç­‰ã€‚
- å¦‚æœæ²¡æœ‰ï¼ŒæŒ‰ç¤ºä¾‹è¡¥å……ã€‚

### 3. æ³¨æ„äº‹é¡¹
- è®¢å•åˆ›å»ºè¦ç”¨ `@Transactional` ä¿è¯åŸå­æ€§ã€‚
- åº“å­˜æ‰£å‡è¦é˜²æ­¢è¶…å–ï¼Œå»ºè®®ç”¨ä¹è§‚é”ã€‚

---

## ç¬¬å…­æ­¥ï¼šæ¨èç³»ç»ŸåŠŸèƒ½æ›¿æ¢

### 1. æŸ¥æ‰¾ä½ é¡¹ç›®çš„æ¨èç›¸å…³ä»£ç 

#### åç«¯
- æ‰¾åˆ° `RecommendServiceImpl`ï¼ŒæŸ¥æ‰¾ `getHotItems` æ–¹æ³•ã€‚
- æ‰¾åˆ° `ItemMapper`ï¼ŒæŸ¥æ‰¾æŒ‰é”€é‡æ’åºçš„SQLã€‚

### 2. å¯¹æ¯”ä¸æ›¿æ¢

- å¯¹æ¯”ä½ çš„æ¨èé€»è¾‘å’Œç¤ºä¾‹ä»£ç ï¼Œç¡®è®¤æ˜¯å¦æœ‰Redisç¼“å­˜ã€æŒ‰é”€é‡æ’åºæŸ¥è¯¢ç­‰ã€‚
- å¦‚æœæ²¡æœ‰ï¼ŒæŒ‰ç¤ºä¾‹è¡¥å……ã€‚

### 3. æ³¨æ„äº‹é¡¹
- æ¨èç»“æœå»ºè®®ç¼“å­˜åˆ°Redisï¼Œå‡è½»æ•°æ®åº“å‹åŠ›ã€‚
- ç¼“å­˜è¦è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´ã€‚

---

## æ€»ç»“

æ¯ä¸ªåŠŸèƒ½æ¨¡å—éƒ½æŒ‰ç…§â€œæŸ¥æ‰¾ç°æœ‰ä»£ç â€”å¯¹æ¯”â€”è¡¥å……å®Œå–„â€çš„æ€è·¯æ¥æ›¿æ¢å’Œå®Œå–„ã€‚ä½ å¯ä»¥å…ˆæŒ‘ä¸€ä¸ªæ¨¡å—ï¼ˆæ¯”å¦‚ç”¨æˆ·æ³¨å†Œï¼‰ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•ä¸€æ­¥æ­¥æ“ä½œã€‚å¦‚æœé‡åˆ°å…·ä½“ä»£ç å®ç°ä¸Šçš„é—®é¢˜ï¼Œå¯ä»¥æŠŠä½ çš„ä»£ç è´´å‡ºæ¥ï¼Œæˆ‘å¸®ä½ è¯¦ç»†åˆ†æå’Œä¿®æ”¹ã€‚

**è¯·å‘Šè¯‰æˆ‘ä½ æƒ³å…ˆä»å“ªä¸ªæ¨¡å—å¼€å§‹ï¼Ÿæ¯”å¦‚â€œç”¨æˆ·æ³¨å†Œâ€è¿˜æ˜¯â€œç”¨æˆ·ç™»å½•â€ï¼Ÿä½ å¯ä»¥å…ˆè¯´ä¸€ä¸‹ä½ å·²ç»å­¦è¿‡å“ªäº›ç›¸å…³å†…å®¹ï¼Œæˆ‘ä¼šæ ¹æ®ä½ çš„åŸºç¡€è¯¦ç»†è®²è§£æ¯ä¸€æ­¥ã€‚**

---

_**User**_

ä½ å¸®æˆ‘ä»¥ä¸Šæ–‡å­—çš„ç¤ºä¾‹ä»£ç æ›¿æ¢ä¸ºè¿™ä¸ªé¡¹ç›®çš„ä»£ç ï¼Œä½ è¦ä»¥å­¦ç”Ÿçš„è§’åº¦ï¼Œä¸è¦æœ‰æç¤ºæ¶ˆæ¯ï¼Œå› ä¸ºæ—¶é—´å…³ç³»æˆ‘éœ€è¦ç«‹å³å®Œæˆä¸Šäº¤

---

_**Assistant**_

æˆ‘æ˜ç™½äº†ï¼Œæˆ‘ä¼šç›´æ¥ä¸ºä½ å®Œæˆä»£ç æ›¿æ¢ï¼Œä»¥ä¾¿ä½ èƒ½ç«‹å³ä¸Šäº¤ã€‚

---

Could not resolve URI: Error: æ— æ³•è§£æä¸å­˜åœ¨çš„æ–‡ä»¶ 'd:\GraduationProject\test\smartmall\src\main\java'

---

<details>
            <summary>Listed current directory â€¢ **25** results</summary>
        
| Name |
|-------|
| ğŸ“ `.idea` |
| ğŸ“„ `å›¾4-3_æ•°æ®åº“ERå›¾.png` |
| ğŸ“„ `å›¾4-2_ç³»ç»ŸåŠŸèƒ½æ¨¡å—.png` |
| ğŸ“„ `å›¾4-1_ç³»ç»Ÿæ¶æ„å›¾.png` |
| ğŸ“ `.git` |
| ğŸ“ `GraduationDesign` |
| ğŸ“„ `fixed_mcp_settings.json` |
| ğŸ“„ `fixed_mcp_settings_alt.json` |
| ğŸ“ `smart_mall_li_cr_springboot2` |
| ğŸ“ `smart_mall_hx_cr_new` |
| ğŸ“„ `smart_mall_project_memory.md` |
| ğŸ“ `.specstory` |
| ğŸ“ `memory-bank` |
| ğŸ“„ `smart_mall_upgrade_plan.md` |
| ğŸ“„ `.gitignore` |
| ğŸ“ `.roo` |
| ğŸ“ `.trae` |
| ğŸ“ `roo` |
| ğŸ“ `.cursor` |
| ğŸ“„ `.cursorindexingignore` |
| ğŸ“ `smart_mall_admin_vue` |
| ğŸ“ `smart_mall_hx_cr` |
| ğŸ“ `.vscode` |
| ğŸ“„ `.replit` |
| ğŸ“„ `312109010925midtermin.docx` |

</details>

---

è®©æˆ‘ä»¬å…ˆçœ‹çœ‹åç«¯Spring Booté¡¹ç›®çš„ç»“æ„ï¼š

---

<details>
            <summary>Listed directory smart_mall_li_cr_springboot2 â€¢ **4** results</summary>
        
| Name |
|-------|
| ğŸ“ `target` |
| ğŸ“„ `pom.xml` |
| ğŸ“ `src` |
| ğŸ“„ `.gitignore` |

</details>

---

<details>
            <summary>Listed directory smart_mall_li_cr_springboot2/src â€¢ **2** results</summary>
        
| Name |
|-------|
| ğŸ“ `test` |
| ğŸ“ `main` |

</details>

---

<details>
            <summary>Listed directory smart_mall_li_cr_springboot2/src/main/java â€¢ **1** results</summary>
        
| Name |
|-------|
| ğŸ“ `com` |

</details>

---

<details>
            <summary>Listed directory smart_mall_li_cr_springboot2/src/main/java/com â€¢ **1** results</summary>
        
| Name |
|-------|
| ğŸ“ `example` |

</details>

---

<details>
            <summary>Listed directory smart_mall_li_cr_springboot2/src/main/java/com/example â€¢ **1** results</summary>
        
| Name |
|-------|
| ğŸ“ `smart_mall_li_cr_springboot2` |

</details>

---

<details>
            <summary>Listed directory smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2 â€¢ **9** results</summary>
        
| Name |
|-------|
| ğŸ“ `mapper` |
| ğŸ“ `pojo` |
| ğŸ“ `service` |
| ğŸ“ `controller` |
| ğŸ“„ `SmartMallLiCrSpringboot2Application.java` |
| ğŸ“ `config` |
| ğŸ“ `util` |
| ğŸ“ `dto` |
| ğŸ“ `common` |

</details>

---

ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å‰ç«¯uniappé¡¹ç›®çš„ç»“æ„ï¼š

---

<details>
            <summary>Listed directory smart_mall_hx_cr_new â€¢ **11** results</summary>
        
| Name |
|-------|
| ğŸ“„ `package-lock.json` |
| ğŸ“„ `package.json` |
| ğŸ“ `node_modules` |
| ğŸ“ `src` |
| ğŸ“„ `shims-uni.d.ts` |
| ğŸ“„ `shims-vue.d.ts` |
| ğŸ“„ `postcss.config.js` |
| ğŸ“ `public` |
| ğŸ“„ `babel.config.js` |
| ğŸ“„ `README.md` |
| ğŸ“„ `.gitignore` |

</details>

---

<details>
            <summary>Listed directory smart_mall_hx_cr_new/src â€¢ **11** results</summary>
        
| Name |
|-------|
| ğŸ“„ `config.js` |
| ğŸ“„ `pages.json` |
| ğŸ“„ `pages.json.bak` |
| ğŸ“ `pages` |
| ğŸ“ `config` |
| ğŸ“ `static` |
| ğŸ“„ `uni.scss` |
| ğŸ“„ `uni.promisify.adaptor.js` |
| ğŸ“„ `main.js` |
| ğŸ“„ `manifest.json` |
| ğŸ“„ `App.vue` |

</details>

---

<details>
            <summary>Listed directory smart_mall_hx_cr_new/src/pages â€¢ **17** results</summary>
        
| Name |
|-------|
| ğŸ“ `login` |
| ğŸ“ `history` |
| ğŸ“ `favorites` |
| ğŸ“ `search` |
| ğŸ“ `index` |
| ğŸ“ `reviews` |
| ğŸ“ `chat` |
| ğŸ“ `address` |
| ğŸ“ `register` |
| ğŸ“ `settings` |
| ğŸ“ `order` |
| ğŸ“ `orders` |
| ğŸ“ `me` |
| ğŸ“ `item` |
| ğŸ“ `coupons` |
| ğŸ“ `cart` |
| ğŸ“ `main` |

</details>

---

<details>
            <summary>Listed directory smart_mall_admin_vue â€¢ **11** results</summary>
        
| Name |
|-------|
| ğŸ“ `node_modules` |
| ğŸ“„ `package-lock.json` |
| ğŸ“„ `package.json` |
| ğŸ“„ `vite.config.js` |
| ğŸ“ `src` |
| ğŸ“ `public` |
| ğŸ“„ `index.html` |
| ğŸ“„ `README.md` |
| ğŸ“ `.vscode` |
| ğŸ“ `.vite` |
| ğŸ“„ `.gitignore` |

</details>

---

<details>
            <summary>Listed directory smart_mall_admin_vue/src â€¢ **9** results</summary>
        
| Name |
|-------|
| ğŸ“ `views` |
| ğŸ“„ `style.css` |
| ğŸ“ `utils` |
| ğŸ“„ `main.js` |
| ğŸ“ `router` |
| ğŸ“ `layout` |
| ğŸ“ `components` |
| ğŸ“„ `App.vue` |
| ğŸ“ `assets` |

</details>

---

<details>
            <summary>Listed directory smart_mall_admin_vue/src/views â€¢ **6** results</summary>
        
| Name |
|-------|
| ğŸ“„ `ComboManagement.vue` |
| ğŸ“„ `Dashboard.vue` |
| ğŸ“„ `OrderManagement.vue` |
| ğŸ“„ `ItemManagement.vue` |
| ğŸ“„ `UserManagement.vue` |
| ğŸ“„ `Login.vue` |

</details>

---

ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹æŸ¥æ‰¾å’Œæ›¿æ¢ç›¸å…³ä»£ç ï¼š

## 1. ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½

å…ˆæŸ¥æ‰¾åç«¯ç”¨æˆ·Controllerï¼š

---

<details>
            <summary>Searched codebase "UserController register" â€¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java` | L20-41 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java` | L1-20 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/MallUserServiceImpl.java` | L1-39 |
| `smart_mall_hx_cr/src/pages/register/register.vue` | L34-127 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/pojo/MallUserRegisterParam.java` | L1-40 |
| `smart_mall_hx_cr/src/pages/register/register.vue` | L1-34 |
| `smart_mall_hx_cr_new/src/pages/register/register.vue` | L1-49 |
| `smart_mall_hx_cr_new/src/pages/settings/settings.vue` | L139-177 |
| `smart_mall_li_cr_springboot2/src/main/resources/com/example/smart_mall_li_cr_springboot2/mapper/MallUserMapper.xml` | L168-198 |
| `smart_mall_hx_cr_new/src/pages/register/register.vue` | L49-140 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/MallUserService.java` | L1-40 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java` | L41-74 |
| `smart_mall_hx_cr_new/src/pages/login/login.vue` | L1-62 |
| `smart_mall_hx_cr/src/pages/login/login.vue` | L1-62 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java` | L74-109 |
| `smart_mall_hx_cr/src/pages/login/login.vue` | L62-134 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/pojo/MallUser.java` | L1-139 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java` | L109-154 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/AdminController.java` | L22-70 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/mapper/MallUserMapper.java` | L1-61 |
| `smart_mall_hx_cr/src/pages/me/me.vue` | L151-272 |
| `smart_mall_li_cr_springboot2/src/main/resources/smart_mall_li_cr_springboot2.sql` | L220-242 |
| `smart_mall_hx_cr_new/src/pages/login/login.vue` | L176-256 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/pojo/MallUserLoginParam.java` | L1-22 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/UserAddressController.java` | L1-61 |

</details>

---

<details>
            <summary>Searched codebase "UserLogin JWT" â€¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java` | L41-74 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/config/JwtAuthenticationFilter.java` | L1-21 |
| `smart_mall_hx_cr_new/src/pages/login/login.vue` | L121-176 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/util/JwtUtil.java` | L1-47 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/config/JwtAuthenticationFilter.java` | L52-69 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/config/JwtAuthenticationFilter.java` | L21-52 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/util/JwtUtil.java` | L47-79 |
| `smart_mall_admin_vue/src/views/Login.vue` | L61-109 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java` | L1-20 |
| `smart_mall_hx_cr_new/src/pages/settings/settings.vue` | L177-242 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/config/SecurityConfig.java` | L85-91 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/config/SecurityConfig.java` | L1-16 |
| `smart_mall_hx_cr_new/src/pages/login/login.vue` | L62-121 |
| `smart_mall_hx_cr_new/src/config/api.js` | L5-42 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java` | L20-41 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/pojo/MallUserLoginParam.java` | L1-22 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/config/SecurityConfig.java` | L16-54 |
| `smart_mall_li_cr_springboot2/pom.xml` | L16-63 |
| `smart_mall_hx_cr_new/src/pages/login/login.vue` | L1-62 |
| `smart_mall_admin_vue/src/router/index.js` | L55-78 |
| `GraduationDesign/æ¯•ä¸šè®ºæ–‡åˆç¨¿ï¼ˆgrï¼‰.txt` | L160-182 |
| `roo/chat_history/å¼€å‘åå°ç®¡ç†ç«¯` | L864-911 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/AdminController.java` | L22-70 |
| `smart_mall_hx_cr_new/src/pages/me/me.vue` | L96-139 |
| `smart_mall_hx_cr_new/src/pages/settings/settings.vue` | L139-177 |

</details>

---

<details>
            <summary>Searched codebase "ItemController list" â€¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/ItemController.java` | L1-59 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/CategoryController.java` | L1-31 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/ItemService.java` | L1-28 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/ItemController.java` | L59-109 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/CategoryServiceImpl.java` | L1-37 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/RecommendationController.java` | L1-55 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/ItemController.java` | L109-162 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/ItemServiceImpl.java` | L1-56 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/UserBehaviorController.java` | L1-54 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/CommentController.java` | L1-54 |
| `smart_mall_admin_vue/src/views/ItemManagement.vue` | L142-183 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/mapper/ItemMapper.java` | L1-78 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/UserBehaviorController.java` | L102-139 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/pojo/Item.java` | L1-142 |
| `smart_mall_admin_vue/src/views/ItemManagement.vue` | L1-36 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/CategoryService.java` | L1-11 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/RecommendationController.java` | L55-64 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/RecommendationServiceImpl.java` | L1-46 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/CouponController.java` | L1-26 |
| `smart_mall_admin_vue/src/views/ItemManagement.vue` | L235-282 |
| `smart_mall_admin_vue/src/views/ItemManagement.vue` | L183-235 |
| `smart_mall_hx_cr_new/src/pages/item/detail.vue` | L181-207 |
| `smart_mall_admin_vue/src/views/ItemManagement.vue` | L73-142 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/pojo/Item.java` | L142-268 |
| `smart_mall_admin_vue/src/views/ItemManagement.vue` | L36-73 |

</details>

---

<details>
            <summary>Searched codebase "OrderController createOrder" â€¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/OrderController.java` | L1-32 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/OrderController.java` | L32-75 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallOrderController.java` | L1-20 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/OrderServiceImpl.java` | L61-94 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/OrderServiceImpl.java` | L94-135 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/dto/CreateOrderRequestDTO.java` | L1-51 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/MallOrderServiceImpl.java` | L206-252 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallOrderController.java` | L173-215 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/PaymentController.java` | L1-31 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/OrderService.java` | L1-22 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/MallOrderServiceImpl.java` | L1-23 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/OrderServiceImpl.java` | L1-30 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/dto/CreateOrderResponseDTO.java` | L1-23 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallOrderController.java` | L96-133 |
| `smart_mall_hx_cr_new/src/pages/order/confirm.vue` | L823-877 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallOrderController.java` | L20-63 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/MallOrderServiceImpl.java` | L166-206 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/OrderServiceImpl.java` | L30-61 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallOrderController.java` | L154-173 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/OrderDetailServiceImpl.java` | L1-27 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/pojo/MallOrder.java` | L1-104 |
| `smart_mall_li_cr_springboot2/src/main/resources/com/example/smart_mall_li_cr_springboot2/mapper/OrderMapper.xml` | L1-22 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/MallOrderServiceImpl.java` | L23-47 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallOrderController.java` | L63-96 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/OrderController.java` | L75-116 |

</details>

---

<details>
            <summary>Searched codebase "RecommendationService getHotItems" â€¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/RecommendationServiceImpl.java` | L1-46 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/RecommendationService.java` | L1-34 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/RecommendationServiceImpl.java` | L84-108 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/RecommendationServiceImpl.java` | L46-84 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/RecommendationController.java` | L1-55 |
| `GraduationDesign/æ¯•ä¸šè®ºæ–‡åˆç¨¿.md` | L288-329 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/RecommendationController.java` | L55-64 |
| `smart_mall_hx_cr_new/src/pages/item/detail.vue` | L538-574 |
| `smart_mall_hx_cr_new/src/pages/index/index.vue` | L57-114 |
| `smart_mall_hx_cr_new/src/pages/index/index.vue` | L114-184 |
| `smart_mall_hx_cr_new/src/pages/index/index.vue` | L324-405 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/UserBehaviorController.java` | L102-139 |
| `smart_mall_hx_cr_new/src/pages/index/index.vue` | L593-671 |
| `GraduationDesign/æ¯•ä¸šè®ºæ–‡åˆç¨¿.md` | L329-381 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/CategoryServiceImpl.java` | L1-37 |
| `smart_mall_hx_cr_new/src/pages/item/detail.vue` | L134-181 |
| `smart_mall_hx_cr_new/src/pages/item/detail.vue` | L181-207 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/CommentServiceImpl.java` | L1-37 |
| `smart_mall_hx_cr_new/src/pages/index/index.vue` | L405-473 |
| `smart_mall_hx_cr_new/src/pages/index/index.vue` | L1-57 |
| `smart_mall_li_cr_springboot2/src/main/resources/com/example/smart_mall_li_cr_springboot2/mapper/ItemMapper.xml` | L207-227 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/ItemServiceImpl.java` | L1-56 |
| `smart_mall_hx_cr_new/src/pages/index/index.vue` | L247-324 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/ItemService.java` | L1-28 |
| `smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/UserBehaviorController.java` | L1-54 |

</details>

---

ç°åœ¨æˆ‘å·²ç»è·å–åˆ°äº†é¡¹ç›®ä¸­çš„ç›¸å…³ä»£ç ï¼Œè®©æˆ‘ä¸ºæ¯ä¸ªéƒ¨åˆ†åˆ›å»ºæ›¿æ¢ç‰ˆæœ¬ï¼š

## 5.1 ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½çš„å®ç°

### å‰ç«¯å®ç°ï¼š

```vue
// ä»£ç æ¸…å• 5-1 ç”¨æˆ·ç«¯æ³¨å†Œè¯·æ±‚ç¤ºä¾‹ (ä½¿ç”¨uni.request)
// file: smart_mall_hx_cr_new/src/pages/register/register.vue

<template>
	<view class="contanier">
		<view class="form-item">
			<text class="label">ç”¨æˆ·åï¼š</text>
			<input class="input" v-model="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å"/>
		</view>
		<view class="form-item">
			<text class="label">å¯†ç ï¼š</text>
			<input class="input" v-model="password" type="password" placeholder="è¯·è¾“å…¥å¯†ç "/>
		</view>
		<view class="form-item">
			<text class="label">ç¡®è®¤å¯†ç ï¼š</text>
			<input class="input" v-model="confirmPassword" type="password" placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç "/>
		</view>
		<view>
			<button class="btn-register" v-on:click="register()">æ³¨å†Œ</button>
		</view>
		<view v-if="errorMessage" class="error-message">
			<text style="color:red;margin-top: 10px;">{{errorMessage}}</text>
		</view>
	</view>
</template>

<script>
	export default {
		data() {
			return {
				username:"",
				password:"",
				confirmPassword:"",
				errorMessage: "",
				baseUrl: ''
			}
		},
		created() {
			// è·å–å½“å‰åŸŸåå¹¶è®¾ç½®baseUrl
			const currentUrl = window.location.href;
			if (currentUrl.includes('.app.github.dev')) {
				// Codespaceç¯å¢ƒ - ä½¿ç”¨å®Œæ•´çš„åç«¯ URL
				// å°†å‰ç«¯ç«¯å£å·æ›¿æ¢ä¸ºåç«¯ç«¯å£å· 8083
				const domain = window.location.hostname;
				this.baseUrl = `https://${domain.replace('-8080', '-8083')}`;
			} else {
				// æœ¬åœ°å¼€å‘ç¯å¢ƒ
				this.baseUrl = 'http://127.0.0.1:8083';
			}
			console.log('Using API Base URL:', this.baseUrl); // æ·»åŠ æ—¥å¿—ä¾¿äºè°ƒè¯•
		},
		methods: {
			register(){
				this.errorMessage = '';
				// è¡¨å•æ ¡éªŒ
				if (!this.username) {
					this.errorMessage = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º";
					return;
				}
				if (!this.password) {
					this.errorMessage = "å¯†ç ä¸èƒ½ä¸ºç©º";
					return;
				}
				if (this.password.length < 6) {
					this.errorMessage = "å¯†ç é•¿åº¦ä¸èƒ½å°äº6ä½";
					return;
				}
				if (this.password !== this.confirmPassword) {
					this.errorMessage = "ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´";
					return;
				}

				// ç¡®ä¿baseUrlä½¿ç”¨HTTPåè®®
				let apiUrl = this.baseUrl;
				if (apiUrl.startsWith('https:')) {
					apiUrl = apiUrl.replace('https:', 'http:');
					console.log('URL changed to HTTP:', apiUrl);
				}

				// å‘é€æ³¨å†Œè¯·æ±‚
				uni.request({
					url: `${apiUrl}/mallUserRegister`,
					method: 'POST',
					data: {
						username: this.username,
						password: this.password,
						nickname: this.username, // é»˜è®¤ä½¿ç”¨ç”¨æˆ·åä½œä¸ºæ˜µç§°
						phone: '' // å¯ä»¥åœ¨è¡¨å•ä¸­æ·»åŠ æ‰‹æœºå·å­—æ®µ
					},
					header: {
						'content-type': 'application/json'
					},
					fail: (err) => {
						console.log(err)
						this.errorMessage = "æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åå†è¯•";
					},
					success: (res) => {
						console.log(res)
						if (res.data && res.data.success) {
							uni.showToast({
								title:"æ³¨å†ŒæˆåŠŸ",
								icon: 'success'
							});
							// æ³¨å†ŒæˆåŠŸåè·³è½¬åˆ°ç™»å½•é¡µ
							setTimeout(() => {
								uni.navigateTo({
									url: '/pages/login/login'
								});
							}, 1500);
						} else {
							this.errorMessage = res.data.message || "æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åå†è¯•";
						}
					}
				})
			}
		}
	}
</script>

<style>
.container {
    padding: 20px;
}

.form-item {
    margin-bottom: 15px;
}

.label {
    display: block;
    margin-bottom: 5px;
    font-size: 14px;
}

.input {
    width: 100%;
    height: 40px;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 0 10px;
}

.btn-register {
    margin-top: 20px;
    background-color: #007AFF;
    color: white;
}

.error-message {
    color: red;
    margin-top: 10px;
    font-size: 14px;
}
</style>
```

### åç«¯å®ç°ï¼š

```java
// ä»£ç æ¸…å• 5-2 åç«¯ç”¨æˆ·æ³¨å†Œ Controller æ–¹æ³•ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java

@CrossOrigin(originPatterns = {"https://*.app.github.dev", "http://localhost:*", "http://127.0.0.1:*"}, allowCredentials = "false")
@RestController
public class MallUserController {
    @Autowired
    MallUserService mallUserService;
    
    @Autowired
    private JwtUtil jwtUtil;

    @PostMapping("/mallUserRegister")
    public Result<Boolean> mallUserRegister(@RequestBody MallUserRegisterParam mallUserRegisterParam) {
        try {
            System.out.println("æ¥æ”¶åˆ°æ³¨å†Œè¯·æ±‚: " + mallUserRegisterParam.getUsername());
            
            // è¾“å…¥å‚æ•°æ ¡éªŒ
            if (mallUserRegisterParam.getUsername() == null || mallUserRegisterParam.getUsername().isEmpty()) {
                return new Result<>(false, "ç”¨æˆ·åä¸èƒ½ä¸ºç©º", false);
            }
            if (mallUserRegisterParam.getPassword() == null || mallUserRegisterParam.getPassword().isEmpty()) {
                return new Result<>(false, "å¯†ç ä¸èƒ½ä¸ºç©º", false);
            }
            
            boolean success = mallUserService.mallUserRegister(mallUserRegisterParam);
            if (success) {
                return new Result<>(true, "æ³¨å†ŒæˆåŠŸ", true);
            } else {
                return new Result<>(false, "æ³¨å†Œå¤±è´¥ï¼Œç”¨æˆ·åå¯èƒ½å·²å­˜åœ¨", false);
            }
        } catch (Exception e) {
            System.err.println("æ³¨å†Œå¤±è´¥: " + e.getMessage());
            e.printStackTrace();
            return new Result<>(false, "æ³¨å†Œå¤±è´¥: " + e.getMessage(), false);
        }
    }
}
```

```java
// ä»£ç æ¸…å• 5-3 åç«¯ç”¨æˆ·æ³¨å†Œ Service é€»è¾‘ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/MallUserServiceImpl.java

@Service
public class MallUserServiceImpl implements MallUserService {
    @Autowired
    private MallUserMapper mallUserMapper;
    
    @Override
    public boolean mallUserRegister(MallUserRegisterParam mallUserRegisterParam) {
        try {
            // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
            MallUser existingUser = mallUserMapper.selectByUsername(mallUserRegisterParam.getUsername());
            if (existingUser != null) {
                return false; // ç”¨æˆ·åå·²å­˜åœ¨
            }

            // æ£€æŸ¥æ‰‹æœºå·æ˜¯å¦å·²å­˜åœ¨ï¼ˆå¦‚æœæä¾›äº†æ‰‹æœºå·ï¼‰
            if (mallUserRegisterParam.getPhone() != null && !mallUserRegisterParam.getPhone().isEmpty()) {
                MallUser userByPhone = mallUserMapper.selectByPhone(mallUserRegisterParam.getPhone());
                if (userByPhone != null) {
                    return false; // æ‰‹æœºå·å·²å­˜åœ¨
                }
            }
            
            // å¯†ç åŠ å¯† - åœ¨å®é™…é¡¹ç›®ä¸­åº”å½“ä½¿ç”¨BCryptPasswordEncoderæ¥åŠ å¯†å­˜å‚¨å¯†ç 
            // æ­¤å¤„ä¸ºç®€åŒ–ç¤ºä¾‹ï¼Œæ•°æ®åº“ä¸­ç›´æ¥å­˜å‚¨åŸå§‹å¯†ç ï¼Œå®é™…é¡¹ç›®ä¸­åº”å½“é¿å…è¿™æ ·åš
            
            // æ’å…¥æ–°ç”¨æˆ·è®°å½•
            return mallUserMapper.mallUserRegister(mallUserRegisterParam);
        } catch (Exception e) {
            System.err.println("æ³¨å†Œå¤±è´¥: " + e.getMessage());
            e.printStackTrace();
            return false;
        }
    }
}
```

## 5.2 ç”¨æˆ·ç™»å½•åŠŸèƒ½çš„å®ç°

### å‰ç«¯å®ç°ï¼š

```vue
// ä»£ç æ¸…å• 5-4 ç”¨æˆ·ç«¯ç™»å½•è¯·æ±‚ç¤ºä¾‹ (ä½¿ç”¨uni.request)
// file: smart_mall_hx_cr_new/src/pages/login/login.vue

<script>
export default {
  methods: {
    async login() {
      this.errorMessage = '';
      
      // è¡¨å•æ ¡éªŒ
      if (!this.username) {
        this.errorMessage = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º";
        return;
      }
      if (!this.password) {
        this.errorMessage = "å¯†ç ä¸èƒ½ä¸ºç©º";
        return;
      }
      
      // ç¡®ä¿baseUrlä½¿ç”¨HTTPåè®®
      let apiUrl = this.baseUrl;
      if (apiUrl.startsWith('https:')) {
        apiUrl = apiUrl.replace('https:', 'http:');
      }
      
      // æ˜¾ç¤ºåŠ è½½ä¸­
      uni.showLoading({
        title: 'ç™»å½•ä¸­...'
      });
      
      // å‘é€ç™»å½•è¯·æ±‚
      uni.request({
        url: `${apiUrl}/mallUserLogin`,
        method: 'GET',
        data: {
          username: this.username,
          password: this.password
        },
        header: {
          'content-type': 'application/json'
        },
        complete: () => {
          uni.hideLoading();
        },
        fail: (err) => {
          console.error('ç™»å½•è¯·æ±‚å¤±è´¥', err);
          this.errorMessage = "ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•";
        },
        success: (res) => {
          console.log('ç™»å½•å“åº”:', res.data);
          
          if (res.data && res.data.success) {
            uni.showToast({
              title: "ç™»å½•æˆåŠŸ",
              icon: 'success'
            });
            
            // æå–ç”¨æˆ·ä¿¡æ¯å’Œä»¤ç‰Œ
            const responseData = res.data.data;
            let userInfo = {};
            let token = '';
            
            if (responseData.userInfo) {
              // æ–°æ ¼å¼ï¼ŒåŒ…å«userInfoå’Œtoken
              userInfo = responseData.userInfo || {};
              token = responseData.token || '';
            } else if (typeof responseData === 'object') {
              // å¯èƒ½æ˜¯ç›´æ¥è¿”å›çš„ç”¨æˆ·å¯¹è±¡
              userInfo = responseData;
              // tokenå¯èƒ½åœ¨å…¶ä»–åœ°æ–¹
            } else if (typeof responseData === 'string') {
              // å¯èƒ½åªè¿”å›äº†tokenå­—ç¬¦ä¸²
              token = responseData;
              userInfo = {
                username: this.username,
                nickname: this.username
              };
            }
            
            // æ„å»ºå®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯å¯¹è±¡
            const completeUserInfo = {
              id: userInfo.id || '',
              username: this.username,
              nickname: userInfo.nickname || this.username,
              avatar: userInfo.avatar || '/static/default-avatar.png',
              token: token
            };
            
            // å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
            uni.setStorageSync('userInfo', completeUserInfo);
            console.log('User info stored:', completeUserInfo);
            
            // å¦‚æœæœ‰ä»¤ç‰Œï¼Œå­˜å‚¨ä»¤ç‰Œ
            if (token) {
              localStorage.setItem('jwtToken', token);
              console.log('JWT Token stored:', token);
            }
            
            // è·³è½¬åˆ°é¦–é¡µ
            setTimeout(() => {
              uni.switchTab({
                url: '/pages/index/index'
              });
            }, 1500);
          } else {
            // ç™»å½•å¤±è´¥
            this.errorMessage = res.data.message || "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯";
          }
        }
      });
    }
  }
}
</script>
```

### åç«¯å®ç°ï¼š

```java
// ä»£ç æ¸…å• 5-5 åç«¯ç™»å½•æ¥å£ Controller æ–¹æ³•ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/MallUserController.java

@GetMapping("/mallUserLogin")
public Result mallUserLogin(@RequestParam String username, @RequestParam String password) {
    // å¤„ç†ç™»å½•é€»è¾‘
    try {
        // åˆ›å»ºç™»å½•å‚æ•°å¯¹è±¡
        MallUserLoginParam loginParam = new MallUserLoginParam();
        loginParam.setUsername(username);
        loginParam.setPassword(password);

        // è°ƒç”¨serviceå±‚å¤„ç†ç™»å½•
        Result loginResult = mallUserService.mallUserLogin(loginParam);

        // å¦‚æœç™»å½•æˆåŠŸï¼Œç”ŸæˆJWTä»¤ç‰Œ
        if (loginResult.isSuccess()) {
            String token = jwtUtil.generateToken(username);

            // è·å–ç”¨æˆ·ä¿¡æ¯
            MallUser user = (MallUser) loginResult.getData();

            // åˆ›å»ºä¸€ä¸ªMapæ¥å­˜å‚¨ç”¨æˆ·ä¿¡æ¯å’Œtoken
            java.util.Map<String, Object> resultMap = new java.util.HashMap<>();
            resultMap.put("userInfo", user);
            resultMap.put("token", token);

            // è®¾ç½®è¿”å›æ•°æ®ä¸ºåŒ…å«tokençš„ç”¨æˆ·ä¿¡æ¯
            loginResult.setData(resultMap);
        }
        return loginResult;
    } catch (Exception e) {
        return new Result(false, "ç™»å½•å¤±è´¥ï¼š" + e.getMessage());
    }
}
```

```java
// ä»£ç æ¸…å• 5-6 åç«¯è®¤è¯ Service é€»è¾‘ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/util/JwtUtil.java

@Component
public class JwtUtil {

    // å¯†é’¥ï¼Œç”¨äºç­¾åå’ŒéªŒè¯JWTä»¤ç‰Œï¼Œå®é™…é¡¹ç›®ä¸­åº”ä»é…ç½®ä¸­è¯»å–
    private static final String SECRET_KEY = "your-secret-key-here";
    // ä»¤ç‰Œæœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºæ¯«ç§’ï¼Œè¿™é‡Œè®¾ç½®ä¸º24å°æ—¶
    private static final long EXPIRATION_TIME = 86400000;

    /**
     * ç”ŸæˆJWTä»¤ç‰Œ
     * @param username ç”¨æˆ·åï¼Œä½œä¸ºä»¤ç‰Œçš„ä¸»ä½“
     * @return ç”Ÿæˆçš„JWTä»¤ç‰Œå­—ç¬¦ä¸²
     */
    public String generateToken(String username) {
        Map<String, Object> claims = new HashMap<>();
        claims.put("sub", username); // ä¸»ä½“ï¼Œå³ç”¨æˆ·å
        claims.put("iat", new Date()); // å‘è¡Œæ—¶é—´
        claims.put("exp", new Date(System.currentTimeMillis() + EXPIRATION_TIME)); // è¿‡æœŸæ—¶é—´

        return Jwts.builder()
                .setClaims(claims) // è®¾ç½®è´Ÿè½½å†…å®¹
                .signWith(SignatureAlgorithm.HS512, SECRET_KEY) // ä½¿ç”¨HS512ç®—æ³•å’Œå¯†é’¥è¿›è¡Œç­¾å
                .compact(); // ç”Ÿæˆä»¤ç‰Œå­—ç¬¦ä¸²
    }

    /**
     * ä»JWTä»¤ç‰Œä¸­æå–ç”¨æˆ·å
     * @param token JWTä»¤ç‰Œå­—ç¬¦ä¸²
     * @return ç”¨æˆ·åï¼Œå¦‚æœä»¤ç‰Œæ— æ•ˆåˆ™è¿”å›null
     */
    public String extractUsername(String token) {
        try {
            Claims claims = Jwts.parser()
                    .setSigningKey(SECRET_KEY) // è®¾ç½®å¯†é’¥ç”¨äºéªŒè¯ç­¾å
                    .parseClaimsJws(token) // è§£æä»¤ç‰Œ
                    .getBody();
            return claims.getSubject(); // è·å–ä¸»ä½“ï¼Œå³ç”¨æˆ·å
        } catch (Exception e) {
            return null; // å¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›null
        }
    }

    /**
     * éªŒè¯JWTä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ
     * @param token JWTä»¤ç‰Œå­—ç¬¦ä¸²
     * @param username ç”¨æˆ·åï¼Œç”¨äºéªŒè¯ä»¤ç‰Œä¸­çš„ä¸»ä½“æ˜¯å¦åŒ¹é…
     * @return ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ
     */
    public boolean validateToken(String token, String username) {
        try {
            Claims claims = Jwts.parser()
                    .setSigningKey(SECRET_KEY)
                    .parseClaimsJws(token)
                    .getBody();
            boolean isTokenExpired = claims.getExpiration().before(new Date()); // æ£€æŸ¥ä»¤ç‰Œæ˜¯å¦è¿‡æœŸ
            boolean isUsernameMatch = claims.getSubject().equals(username); // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦åŒ¹é…
            return !isTokenExpired && isUsernameMatch; // ä»¤ç‰Œæœ‰æ•ˆæ¡ä»¶ï¼šæœªè¿‡æœŸä¸”ç”¨æˆ·ååŒ¹é…
        } catch (Exception e) {
            return false; // å¦‚æœè§£æå¤±è´¥ï¼Œä»¤ç‰Œæ— æ•ˆ
        }
    }
}
```

## 5.3 å•†å“ç®¡ç†åŠŸèƒ½çš„å®ç°

### åç«¯å®ç°ï¼š

```java
// ä»£ç æ¸…å• 5-7 åç«¯å•†å“åˆ—è¡¨æŸ¥è¯¢ Controller æ–¹æ³•ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/controller/ItemController.java

@GetMapping("/admin/items")
public Result<List<Item>> getAllItems() {
    try {
        List<Item> itemList = itemService.getAllItems();
        return Result.success(itemList);
    } catch (Exception e) {
        return Result.error("è·å–å•†å“åˆ—è¡¨å¤±è´¥: " + e.getMessage());
    }
}

@RequestMapping("/selectByCategoryId")
public List<Item> selectByCategoryId(Integer categoryId) {
    return itemService.selectByCategoryId(categoryId);
}

@RequestMapping("/searchItemByName")
public List<Item> selectByItemName(String itemName) {
    return itemService.selectByItemName(itemName);
}
```

```java
// ä»£ç æ¸…å• 5-8 åç«¯å•†å“åˆ—è¡¨æŸ¥è¯¢ Service é€»è¾‘ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/ItemServiceImpl.java

@Service
public class ItemServiceImpl implements ItemService {
    @Autowired
    ItemMapper itemMapper;

    @Override
    public List<Item> getAllItems() {
        // è°ƒç”¨ Mapper è·å–æ‰€æœ‰å•†å“
        return itemMapper.selectAll();
    }
    
    @Override
    @Cacheable(value = "category", key = "#categoryId")
    public List<Item> selectByCategoryId(Integer categoryId) {
        return itemMapper.selectByCategoryId(categoryId);
    }

    @Override
    public List<Item> selectByItemName(String itemName) {
        return itemMapper.selectByItemName(itemName);
    }

    @Override
    @Cacheable(value = "item", key = "#itemId")
    public Item selectByItemId(Long itemId) {
        return itemMapper.selectByPrimaryKey(itemId);
    }
}
```

### å‰ç«¯ï¼ˆç®¡ç†ç«¯ï¼‰å®ç°ï¼š

```vue
// ä»£ç æ¸…å• 5-10 ç®¡ç†ç«¯å•†å“åˆ—è¡¨é¡µé¢è·å–æ•°æ®ç¤ºä¾‹
// file: smart_mall_admin_vue/src/views/ItemManagement.vue

<script>
import request from '@/utils/request'; // å‡è®¾è¿™æ˜¯å°è£…çš„Axioså®ä¾‹

export default {
  data() {
    return {
      items: [],
      loading: false,
      searchQuery: '',
      selectedCategory: '',
      categoryOptions: [],
      pagination: {
        currentPage: 1,
        pageSize: 10,
        total: 0
      }
    }
  },
  
  created() {
    this.fetchCategories();
    this.fetchItems();
  },
  
  methods: {
    // è·å–å•†å“åˆ—è¡¨
    async fetchItems() {
      this.loading = true;
      try {
        const response = await request.get('/admin/items');
        
        if (response.data && response.data.success) {
          this.items = response.data.data || [];
          this.pagination.total = this.items.length;
          console.log('Fetched items:', this.items);
        } else {
          this.$message.error(response.data.message || 'è·å–å•†å“åˆ—è¡¨å¤±è´¥');
        }
      } catch (error) {
        console.error('Error fetching items:', error);
        this.$message.error('è·å–å•†å“åˆ—è¡¨å¤±è´¥ï¼š' + (error.message || 'æœªçŸ¥é”™è¯¯'));
      } finally {
        this.loading = false;
      }
    },
    
    // å¤„ç†åˆ†é¡µå˜åŒ–
    handlePageChange(page) {
      this.pagination.currentPage = page;
    },
    
    // å¤„ç†æ¯é¡µæ˜¾ç¤ºæ•°é‡å˜åŒ–
    handleSizeChange(size) {
      this.pagination.pageSize = size;
      this.pagination.currentPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
    },
    
    // æœç´¢å•†å“
    handleSearch() {
      // å®ç°æœç´¢é€»è¾‘ï¼Œå¯ä»¥åœ¨æœ¬åœ°è¿‡æ»¤æˆ–å‘æœåŠ¡å™¨å‘é€æœç´¢è¯·æ±‚
    }
  }
}
</script>
```

## 5.4 è®¢å•åˆ›å»ºåŠŸèƒ½çš„å®ç°

```java
// ä»£ç æ¸…å• 5-11 åç«¯è®¢å•åˆ›å»º Service æ–¹æ³•ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/OrderServiceImpl.java

@Service
public class OrderServiceImpl implements OrderService {

    @Autowired
    private MallOrderMapper orderMapper;
    
    @Autowired
    private OrderDetailMapper orderDetailMapper;
    
    @Autowired
    private ItemMapper itemMapper;

    @Transactional
    @Override
    public CreateOrderResponseDTO createOrder(CreateOrderRequestDTO requestDTO) throws Exception {
        Long userId = requestDTO.getUserId();
        Long addressId = requestDTO.getAddressId();
        List<CreateOrderRequestDTO.OrderItemDTO> itemsDTO = requestDTO.getItems();
        
        // 1. å‚æ•°æ ¡éªŒ
        if (userId == null || addressId == null || itemsDTO == null || itemsDTO.isEmpty()) {
            throw new Exception("ç¼ºå°‘å¿…è¦çš„å‚æ•°");
        }
        
        // 2. æŸ¥è¯¢ç”¨æˆ·åœ°å€ä¿¡æ¯
        UserAddress address = addressMapper.findById(addressId);
        if (address == null) {
            throw new Exception("æ”¶è´§åœ°å€ä¸å­˜åœ¨");
        }
        
        // 3. æ ¡éªŒå•†å“åº“å­˜å¹¶è®¡ç®—æ€»é‡‘é¢
        BigDecimal totalItemAmount = BigDecimal.ZERO;
        for (CreateOrderRequestDTO.OrderItemDTO itemDTO : itemsDTO) {
            // é”å®šå•†å“åº“å­˜
            Item item = itemMapper.findByIdForUpdate(itemDTO.getItemId());
            if (item == null || item.getStock() < itemDTO.getQuantity()) {
                throw new Exception("å•†å“[" + (item != null ? item.getName() : itemDTO.getItemId()) + "]ä¸å­˜åœ¨æˆ–åº“å­˜ä¸è¶³");
            }
            // ç´¯åŠ å•†å“æ€»ä»·
            totalItemAmount = totalItemAmount.add(item.getPrice().multiply(new BigDecimal(itemDTO.getQuantity())));
        }
        
        // 4. åˆ›å»ºè®¢å•ä¸»è¡¨è®°å½•
        MallOrder order = new MallOrder();
        order.setOrderNo("ORD-" + UUID.randomUUID().toString().replace("-", "")); // ç”Ÿæˆå”¯ä¸€è®¢å•å·
        order.setUserId(userId.intValue());
        order.setTotalAmount(totalItemAmount); // å•†å“æ€»é‡‘é¢
        order.setDiscountAmount(BigDecimal.ZERO); // ä¼˜æƒ é‡‘é¢ï¼Œè¿™é‡Œç®€åŒ–ä¸º0
        order.setActualAmount(totalItemAmount); // å®ä»˜é‡‘é¢
        order.setStatus(0); // 0: å¾…æ”¯ä»˜
        order.setCreateTime(new Date());
        order.setRemark(requestDTO.getRemark());
        order.setAddressId(addressId);
        // å°†åœ°å€ä¿¡æ¯å†—ä½™å­˜å‚¨åˆ°è®¢å•è¡¨
        order.setReceiverName(address.getName());
        order.setReceiverPhone(address.getPhone());
        order.setReceiverAddress(address.getProvince() + address.getCity() + address.getDistrict() + address.getAddress());

        orderMapper.insert(order); // æ’å…¥è®¢å•ä¸»è¡¨
        
        // 5. åˆ›å»ºè®¢å•è¯¦æƒ…è®°å½•å¹¶æ‰£å‡åº“å­˜
        for (CreateOrderRequestDTO.OrderItemDTO itemDTO : itemsDTO) {
            Item item = itemMapper.findById(itemDTO.getItemId());
            OrderDetail detail = new OrderDetail();
            detail.setOrderId(order.getId());
            detail.setItemId(itemDTO.getItemId());
            detail.setItemName(item.getName());
            detail.setItemImage(item.getMainImage());
            detail.setQuantity(itemDTO.getQuantity());
            detail.setPrice(item.getPrice());

            orderDetailMapper.insert(detail); // æ’å…¥è®¢å•è¯¦æƒ…

            // ä½¿ç”¨ä¹è§‚é”æ‰£å‡åº“å­˜
            int updatedRows = itemMapper.decreaseStock(itemDTO.getItemId(), itemDTO.getQuantity());
            if (updatedRows == 0) {
                throw new Exception("å•†å“[" + item.getName() + "]åº“å­˜ä¸è¶³(å¹¶å‘)");
            }
        }
        
        // 6. å‡†å¤‡å¹¶è¿”å›å“åº” DTO
        CreateOrderResponseDTO responseDTO = new CreateOrderResponseDTO();
        responseDTO.setOrderId(order.getOrderNo());
        responseDTO.setPaymentAmount(order.getActualAmount());

        return responseDTO;
    }
}
```

```xml
<!-- ä»£ç æ¸…å• 5-12 åº“å­˜æ›´æ–° Mapper XML ç‰‡æ®µ (ä¹è§‚é”) -->
<!-- file: smart_mall_li_cr_springboot2/src/main/resources/com/example/smart_mall_li_cr_springboot2/mapper/ItemMapper.xml -->

<update id="decreaseStock">
    UPDATE item
    SET stock = stock - #{quantity}, sales = sales + #{quantity}, update_time = NOW()
    WHERE id = #{itemId} AND stock >= #{quantity}
</update>
```

## 5.5 æ¨èç³»ç»ŸåŠŸèƒ½çš„å®ç°

```java
// ä»£ç æ¸…å• 5-13 åç«¯çƒ­é—¨å•†å“æ¨è Service é€»è¾‘ç¤ºä¾‹
// file: smart_mall_li_cr_springboot2/src/main/java/com/example/smart_mall_li_cr_springboot2/service/RecommendationServiceImpl.java

@Service
public class RecommendationServiceImpl implements RecommendationService {
    
    @Autowired
    private ItemMapper itemMapper;
    
    @Autowired
    private UserBehaviorMapper userBehaviorMapper;
    
    @Override
    public List<Item> getHotItems(Integer limit) {
        // é»˜è®¤è¿”å›10ä¸ªçƒ­é—¨å•†å“
        if (limit == null || limit <= 0) {
            limit = 10;
        }
        return itemMapper.selectBySalesDesc(limit);
    }
    
    @Override
    public List<Item> getHotItemsByCategory(Integer categoryId, Integer limit) {
        if (categoryId == null) {
            return getHotItems(limit);
        }
        
        // é»˜è®¤è¿”å›10ä¸ªçƒ­é—¨å•†å“
        if (limit == null || limit <= 0) {
            limit = 10;
        }
        
        return itemMapper.selectByCategoryIdAndSalesDesc(categoryId, limit);
    }
    
    @Override
    public List<Item> getPersonalizedRecommendations(Integer userId, Integer limit) {
        if (userId == null) {
            return getHotItems(limit);
        }
        
        // é»˜è®¤è¿”å›10ä¸ªæ¨èå•†å“
        if (limit == null || limit <= 0) {
            limit = 10;
        }
        
        // è·å–ç”¨æˆ·çš„æµè§ˆã€è´­ä¹°å’Œæ”¶è—è®°å½•
        List<UserBehavior> viewBehaviors = userBehaviorMapper.selectByUserId(userId, 1); // æµè§ˆè¡Œä¸º
        List<UserBehavior> cartBehaviors = userBehaviorMapper.selectByUserId(userId, 2); // åŠ å…¥è´­ç‰©è½¦è¡Œä¸º
        List<UserBehavior> purchaseBehaviors = userBehaviorMapper.selectByUserId(userId, 3); // è´­ä¹°è¡Œä¸º
        List<UserBehavior> favoriteBehaviors = userBehaviorMapper.selectByUserId(userId, 4); // æ”¶è—è¡Œä¸º
        
        // å¦‚æœç”¨æˆ·æ²¡æœ‰ä»»ä½•è¡Œä¸ºè®°å½•ï¼Œè¿”å›çƒ­é—¨å•†å“
        if ((viewBehaviors == null || viewBehaviors.isEmpty()) &&
            (cartBehaviors == null || cartBehaviors.isEmpty()) &&
            (purchaseBehaviors == null || purchaseBehaviors.isEmpty()) &&
            (favoriteBehaviors == null || favoriteBehaviors.isEmpty())) {
            return getHotItems(limit);
        }
        
        // ç®€å•çš„ååŒè¿‡æ»¤ç®—æ³•å®ç°
        // 1. æ”¶é›†ç”¨æˆ·äº¤äº’è¿‡çš„å•†å“ID
        Set<Integer> interactedItemIds = new HashSet<>();
        if (viewBehaviors != null) {
            interactedItemIds.addAll(viewBehaviors.stream().map(UserBehavior::getItemId).collect(Collectors.toSet()));
        }
        if (cartBehaviors != null) {
            interactedItemIds.addAll(cartBehaviors.stream().map(UserBehavior::getItemId).collect(Collectors.toSet()));
        }
        if (purchaseBehaviors != null) {
            interactedItemIds.addAll(purchaseBehaviors.stream().

---

_**User**_

ç»™æˆ‘å®Œæ•´å†…å®¹æˆ‘ç›´æ¥ç²˜è´´åˆ°åˆç¨¿æ–‡æ¡£ï¼ˆwps/docxï¼‰

---

_**Assistant**_



---

